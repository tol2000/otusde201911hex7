-- We accept BROADCAST, BROADCASTJOIN and MAPJOIN for broadcast hint
SELECT /*+ BROADCAST(r) */ * FROM records r JOIN src s ON r.key = s.key

try {
} catch {
  case ex: Exception => {
    println(s"EXCEPTION AT STEP ${i}\nValue: ${wineRow}")
    sys.exit(1)
  }
}


 https://docs.google.com/document/d/1elWInbWsLrIDqB4FMMgFTUMNEmiYev9HJUfg9LXxydE/edit
 https://spark.apache.org/docs/latest/api/sql/index.html#initcap
 https://cwiki.apache.org/confluence/display/Hive/LanguageManual+WindowingAndAnalytics

  def writeToTsv(df:DataFrame) {
    val tsvWithHeaderOptions: Map[String, String] = Map(
      ("delimiter", "\t"), // Uses "\t" delimiter instead of default ","
      ("header", "true"))  // Writes a header record with column names

    df.coalesce(1)         // Writes to a single file
      .write
      .mode(SaveMode.Overwrite)
      .options(tsvWithHeaderOptions)
      .csv(df.getClass.getName+".tsv")
  }
